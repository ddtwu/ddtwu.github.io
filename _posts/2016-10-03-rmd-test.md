---
layout: post
title:  "Rmd<e7><9a>„è<bd>‰æ<8f>›æ¸¬è©<a6>"
date:   2016-10-03
categories: posts
output: html_document
---

<e6><9c>€è¿‘å<9b> ç‚ºå·¥ä<bd>œé<9c>€è¦ï<bc>Œè€é<97>†å¥½å¥‡å¤©æ°<a3>è³‡æ<96>™è<88>‡é<96>€åº—äººæµæ<88>–éŠ·<e5>”®<e6>•¸å­—ç<9a>„é<97>œè¯<e6>€§ï<bc>Œç<9c>‹ä<ba>†ä¸­å¤®æ°£è±¡å<b1>€<e7><9a>„[è³‡æ<96>™ç”³è³¼æ–¹æ³•](http://e-service.cwb.gov.tw/wdps/cwb_fee.htm)ï¼Œç‚ºäº†å<81>šå€‹ç°¡<e5>–®<e7><9a>„POCå°±å<be>—èŠ±<e9>Œ¢è²·è©³ç´°ç<9a>„æ°£è±¡è<b3>‡æ<96>™ï<bc>Œä¼¼ä¹å¤ªå¤§å¼µ<e6><97>—é<bc>“ä<ba>†ã€‚é<82>„å¥½ï¼Œæ°£è±¡å<b1>€<e7><9a>„[è§€æ¸¬è<b3>‡æ<96>™æŸ¥è©¢ç³»çµ±](http://e-service.cwb.gov.tw/HistoryDataQuery/index.jsp)<e5>¯ä»¥æ<8f>ä<be>›æ<89>‹å<8b>•æŸ¥è©¢éƒ¨<e5><88>†æ°£è±¡ç<ab>™ç<9a>„è<b3>‡è<a8>Šï<bc>Œè<a7>€å¯Ÿç¶²<e9><a0>ç<9a>„URLï¼Œåªè¦é€²è<a1>Œæ—¥<e6><9c>Ÿç<9a>„æ›¿<e6><8f>›å°±<e5>¯ä»¥å<81>šç‰¹å®šæ<99>‚é<96>“ç<9a>„æŸ¥è©¢ï<bc>Œè€Œä<b8>”ç”¢<e5>‡º<e7><9a>„é<a0>é¢ä¹Ÿæ˜¯<e6>•´é½Šç<9a>„è¡¨<e6> ¼ï¼Œæ­£å¥½å¯ä»¥æ¸¬è©¦ä½¿<e7>”¨R<e7>ˆ¬<e5><8f>–ç¶²<e9><a0>è<b3>‡æ<96>™ç<9a>„ç<a8>‹å<ba>ã€<82>



{% highlight text %}
## Error in FUN(X[[i]], ...): Package 'stringr' version 1.1.0 cannot be unloaded
{% endhighlight %}



{% highlight text %}
## Warning: package 'scales' was built under R version 3.3.0
{% endhighlight %}

***

<e5><85>ˆå<81>šä<b8>€æ¬¡æ€§ç<9a>„æ¸¬è©<a6>:  


{% highlight r %}
# <U+653C><U+3E35><U+383C><U+3E35>ˆè¨­å®šå¥½ç«™é<U+623C><U+3E62>ç·¨<U+653C><U+3E38><U+393C><U+3E39><U+393C><U+3E66>
stationID <- '466930'

#----------------------------------------------#
# <U+653C><U+3E36><U+393C><U+3E32>ˆå<U+383C><U+3E66>–æ—¥<U+653C><U+3E35> ±(<U+653C><U+3E39>€å<U+623C><U+3E30>æ<U+393C><U+3E39>‚ç<U+393C><U+3E61>„ç<U+623C><U+3E34>€<U+653C><U+3E39><U+383C><U+3E63><U+383C><U+3E34>)
# <U+653C><U+3E35><U+383C><U+3E35>ˆè¨­å®šå¥½æ¬„ä<U+623C><U+3E64>å<U+393C><U+3E30>ç¨±ï¼Œæ<U+393C><U+3E32>ˆå<U+383C><U+3E66>–æ—¥<U+653C><U+3E36><U+393C><U+3E63><U+393C><U+3E66>
tbNames <- c('ObsTime','StnPres','SeaPres','Temperature','TdDewPoint','RH','WS','WD','WSGust','WDGust','Precp','PrecpHour','SunShine','GloblRad','Visb')
fdate <- '2016-09-01'

cwbURL <- sprintf('http://e-service.cwb.gov.tw/HistoryDataQuery/DayDataController.do?command=viewMain&station=%s&stname=%s&datepicker=%s', stationID, '%25E8%2587%25BA%25E5%258C%2597', fdate)
weatherDate <- cwbURL %>%
  getURL() %>%
  htmlParse(., encoding = 'utf8', asText = TRUE) %>%
  readHTMLTable(header = TRUE) %$%
  MyTable %>%
  tbl_dt()

weatherDate %<>% filter(row.names(weatherDate) != 1)
weatherDate %<>% mutate_each(funs(as.numeric(as.character(.)))) %>% arrange(V1)
names(weatherDate) <- tbNames
weatherDate %<>% mutate(station = 'ç«¹å<U+613C><U+3E64>æ<U+623C><U+3E39><U+393C><U+3E36>', cdate = fdate, ctime = (as.POSIXct(fdate)+hours(ObsTime-1)))

#----------------------------------------------#
# <U+653C><U+3E36><U+393C><U+3E32>ˆå<U+383C><U+3E66>–æ<U+393C><U+3E63>ˆå ±(<U+653C><U+3E39>€æ—¥<U+653C><U+3E37><U+393C><U+3E61>„ç<U+623C><U+3E34>€<U+653C><U+3E39><U+383C><U+3E63><U+383C><U+3E34>)
# <U+653C><U+3E35><U+383C><U+3E35>ˆè¨­å®šå¥½æ¬„ä<U+623C><U+3E64>å<U+393C><U+3E30>ç¨±ï¼Œæ<U+393C><U+3E32>ˆå<U+383C><U+3E66>–æ—¥<U+653C><U+3E36><U+393C><U+3E63><U+393C><U+3E66>
tbNames <- c('ObsTime','StnPres','SeaPres','StnPresMax','StnPresMaxTime','StnPresMin','StnPresMinTime','Temperature','TMax','TMaxTime','TMin','TMinTime','TdDewPoint','RH','RHMin','RHMinTime','WS','WD','WSGust','WDGust','WGustTime','Precp','PrecpHour','PrecpMax10','PrecpMax10Time','PrecpHrMax','PrecpHrMaxTime','SunShine','SunShineRate','GloblRad','VisbMean','EvapA')
fmonth <- '2016-09'

cwbURL <- sprintf('http://e-service.cwb.gov.tw/HistoryDataQuery/MonthDataController.do?command=viewMain&station=%s&stname=%s&datepicker=%s', stationID, '%25E7%25AB%25B9%25E5%25AD%2590%25E6%25B9%2596', fmonth)
weatherMonth <- cwbURL %>% 
  getURL() %>% 
  htmlParse(., encoding = 'utf8', asText = TRUE) %>% 
  readHTMLTable(header = TRUE) %$%
  MyTable %>% 
  tbl_dt()

weatherMonth %<>% filter(row.names(weatherMonth) != 1)
weatherMonth %<>% mutate_each(funs(as.numeric(as.character(.)))) %>% arrange(V1) 
names(weatherMonth) <- tbNames
weatherMonth %<>% mutate(station = 'ç«¹å<U+613C><U+3E64>æ<U+623C><U+3E39><U+393C><U+3E36>', cdate = as.Date(str_c(fmonth, ObsTime, sep = '-')))
{% endhighlight %}



{% highlight text %}
## Error: invalid multibyte character in parser at line 21
{% endhighlight %}

***

ç¢ºè<aa>ç<b5>æ<9e>œè¡¨<e9>ƒ½<e6><9c>‰æ<8a>“åˆ°:

{% highlight r %}
# <U+653C><U+3E36>—¥<U+653C><U+3E35> ±(<U+653C><U+3E39>€å<U+623C><U+3E30>æ<U+393C><U+3E39>‚ç<U+393C><U+3E61>„ç<U+623C><U+3E34>€<U+653C><U+3E39><U+383C><U+3E63><U+383C><U+3E34>)
weatherDate %>% head() %>% select(c(1:10)) %>% knitr::kable()
{% endhighlight %}



{% highlight text %}
## Error in eval(expr, envir, enclos): object 'weatherDate' not found
{% endhighlight %}



{% highlight r %}
# <U+653C><U+3E36><U+393C><U+3E63>ˆå ±(<U+653C><U+3E39>€æ—¥<U+653C><U+3E37><U+393C><U+3E61>„ç<U+623C><U+3E34>€<U+653C><U+3E39><U+383C><U+3E63><U+383C><U+3E34>)
weatherMonth %>% head() %>% select(c(1:10)) %>% knitr::kable()
{% endhighlight %}



{% highlight text %}
## Error in eval(expr, envir, enclos): object 'weatherMonth' not found
{% endhighlight %}

***

